<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Linux测试机构建 · 阿尤</title><meta name="description" content="Linux测试机构建 - 阿尤"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/blog/index.ico"><link rel="stylesheet" href="/blog/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://ayou129.github.io/blog/atom.xml" title="阿尤"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="阿尤" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/blog/" class="logo-link"><img src="/blog/index.ico" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/blog/archives/" target="_self" class="nav-list-link">历史文章</a></li><li class="nav-list-item"><a href="/blog/tags" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="/blog/categories" target="_self" class="nav-list-link">分类</a></li><li class="nav-list-item"><a href="/blog/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><!--mixin postList()--><!--    .archive--><!--        - var year = 0;--><!--        - var change = false;--><!--        - page.posts.each(function (item) {--><!--            - var itemYear = date(item.date, 'YYYY') - 0;--><!--            - change = year !== itemYear;--><!--            - year = change ? itemYear : year;--><!--            if change--><!--                h2.archive-year!= year--><!--            .post-item--><!--                +postInfo(item)--><!--                a.post-title-link(href= url_for(item.path))--><!--                    != item.title--><!--        - })--><div class="post"><article class="post-block"><h1 class="post-title">Linux测试机构建</h1><div class="post-info">创建于：2020年1月20日<span style="margin-left: 0.5rem"></span>上次更新：2020年2月20日</div><div class="post-content"><h2 id="Linux版本选择"><a href="#Linux版本选择" class="headerlink" title="Linux版本选择"></a>Linux版本选择</h2><blockquote>
<p><code>https://developer.aliyun.com/mirror/</code> 选择 <code>OS</code> 镜像</p>
</blockquote>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="language-bash">!/usr/bin/env bash</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">初始化</span></span><br><span class="line">output=`yum install -y lrzsz vim wget autoconf`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">设置Centos源</span></span><br><span class="line">cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br><span class="line"><span class="meta"># </span><span class="language-bash">非阿里云服务器</span></span><br><span class="line">output=`sed -i -e &#x27;/mirrors.cloud.aliyuncs.com/d&#x27; -e &#x27;/mirrors.aliyuncs.com/d&#x27; /etc/yum.repos.d/CentOS-Base.repo`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">阿里云服务器</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">output=`<span class="built_in">mv</span> /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup`</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">output=`curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo`</span></span><br><span class="line"></span><br><span class="line">output=`yum makecache`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">git</span></span><br><span class="line">output=`yum install -y git-all`</span><br><span class="line"></span><br><span class="line">output=` `</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">-N 密码 -f 保存文件 -q静默模式</span></span><br><span class="line">output=`ssh-keygen -t rsa -C &quot;guoxinle****e129@gmail&quot; -N &#x27;sisi5201314&#x27; -f id_rsa -q`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">docker</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">step 1: 安装必要的一些系统工具</span></span><br><span class="line">output=`sudo yum install -y yum-utils device-mapper-persistent-data lvm2`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">Step 2: 添加软件源信息</span></span><br><span class="line">output=`sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">Step 3: 更新并安装Docker-CE</span></span><br><span class="line">output=`sudo yum makecache fast`</span><br><span class="line">output=`sudo yum -y install docker-ce-18.03.1.ce-1.el7.centos`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">Step 4: 开启Docker服务</span></span><br><span class="line">output=`systemctl start docker.service`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看安装的版本</span></span><br><span class="line">output=`sudo docker version`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">开机自启</span></span><br><span class="line">output=`systemctl enable docker.service`</span><br><span class="line"></span><br><span class="line">output=`echo &quot;&#123;\&quot;registry-mirrors\&quot;: [\&quot;https://9cpn8tt6.mirror.aliyuncs.com/\&quot;]&#125;&quot; &gt;&gt; /etc/docker/daemon.json`</span><br><span class="line">output=`sudo systemctl daemon-reload`</span><br><span class="line">output=`sudo systemctl restart docker`</span><br></pre></td></tr></table></figure>

<h2 id="设置-Linux-网络"><a href="#设置-Linux-网络" class="headerlink" title="设置 Linux 网络"></a>设置 Linux 网络</h2><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#要保证linux是桥接模式，才能自定义IP</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#修改Linux IP</span></span><br><span class="line"><span class="string">vim</span> /<span class="string">etc</span>/<span class="string">sysconfig</span>/<span class="string">network-scripts</span>/<span class="string">ifcfg-ens33</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#修改Linux 主机名 hostname</span></span><br><span class="line"><span class="string">hostnamectl</span> <span class="built_in">set-hostname</span> <span class="string">xxx</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#子网掩码(24=255.255.255.0)</span></span><br></pre></td></tr></table></figure>

<h2 id="安装基础软件包"><a href="#安装基础软件包" class="headerlink" title="安装基础软件包"></a>安装基础软件包</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vim wget <span class="built_in">auto</span>conf</span><br></pre></td></tr></table></figure>

<h2 id="设置Centos源"><a href="#设置Centos源" class="headerlink" title="设置Centos源"></a>设置Centos源</h2><blockquote>
<p><a href="https://developer.aliyun.com/mirror/centos" target="_blank" rel="noopener">https://developer.aliyun.com/mirror/centos</a></p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份</span></span><br><span class="line">mv <span class="regexp">/etc/yum</span>.repos.d<span class="regexp">/CentOS-Base.repo /</span>etc<span class="regexp">/yum.repos.d/</span>CentOS-Base.repo.backup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 非阿里云ECS用户会出现 Couldn&#x27;t resolve host &#x27;mirrors.cloud.aliyuncs.com&#x27; 信息，不影响使用。用户也可自行修改相关配置: eg:</span></span><br><span class="line">sed -i -e <span class="string">&#x27;/mirrors.cloud.aliyuncs.com/d&#x27;</span> -e <span class="string">&#x27;/mirrors.aliyuncs.com/d&#x27;</span> <span class="regexp">/etc/yum</span>.repos.d/CentOS-Base.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># Centos7</span></span><br><span class="line">curl -o <span class="regexp">/etc/yum</span>.repos.d<span class="regexp">/CentOS-Base.repo https:/</span><span class="regexp">/mirrors.aliyun.com/</span>repo/Centos-<span class="number">7</span>.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># Centos8</span></span><br><span class="line">curl -o <span class="regexp">/etc/yum</span>.repos.d<span class="regexp">/CentOS-Base.repo https:/</span><span class="regexp">/mirrors.aliyun.com/</span>repo/Centos-<span class="number">8</span>.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成缓存</span></span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>
<h2 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#编辑文件</span></span><br><span class="line">vim /etc<span class="built_in">/profile</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="comment">#http代理</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">http_proxy</span>=<span class="string">&quot;http://192.168.3.3:10808&quot;</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">https_proxy</span>=<span class="string">&quot;http://192.168.3.3:10808&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sock5代理</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">http_proxy</span>=<span class="string">&quot;socks5://192.168.3.3:10808&quot;</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">https_proxy</span>=<span class="string">&quot;socks5://192.168.3.3:10808&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#上面只能选择一种代理</span></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h2 id="安装-VMwareTools"><a href="#安装-VMwareTools" class="headerlink" title="安装 VMwareTools"></a>安装 VMwareTools</h2><blockquote>
<p><a href="https://docs.vmware.com/en/VMware-Workstation-Pro/15.0/com.vmware.ws.using.doc/GUID-08BB9465-D40A-4E16-9E15-8C016CC8166F.html" target="_blank" rel="noopener">https://docs.vmware.com/en/VMware-Workstation-Pro/15.0/com.vmware.ws.using.doc/GUID-08BB9465-D40A-4E16-9E15-8C016CC8166F.html</a></p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="regexp">/mnt/</span>cdrom</span><br><span class="line">mount <span class="regexp">/dev/</span>cdrom <span class="regexp">/mnt/</span>cdrom</span><br><span class="line">VM软件上点击安装tools</span><br><span class="line">cd /tmp</span><br><span class="line">tar zxpf <span class="regexp">/mnt/</span>cdrom/VMwareTools-*****.tar.gz</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="安装Php"><a href="#安装Php" class="headerlink" title="安装Php"></a>安装Php</h2><a href="/blog/p/1417dc7c/" title="PHP">PHP</a>

<h2 id="安装Java"><a href="#安装Java" class="headerlink" title="安装Java"></a>安装Java</h2><a href="/blog/p/c8447915/" title="Java核心知识要点">Java核心知识要点</a>

<h2 id="安装Composer"><a href="#安装Composer" class="headerlink" title="安装Composer"></a>安装Composer</h2><a href="/blog/p/d5e309c2/" title="Composer">Composer</a>

<h2 id="安装NodeJs"><a href="#安装NodeJs" class="headerlink" title="安装NodeJs"></a>安装NodeJs</h2><a href="/blog/p/aaeff957/" title="NodeJs">NodeJs</a>

<h2 id="安装Mysql"><a href="#安装Mysql" class="headerlink" title="安装Mysql"></a>安装Mysql</h2><a href="/blog/p/e4d2e8fb/" title="Mysql">Mysql</a>

<h2 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h2><a href="/blog/p/f3599f9d/" title="Redis">Redis</a>

<h2 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><a href="/blog/p/65b69107/" title="Nginx">Nginx</a>

<h2 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装Git</h2><a href="/blog/p/86635873/" title="Git">Git</a>

<h2 id="安装Gitlab"><a href="#安装Gitlab" class="headerlink" title="安装Gitlab"></a>安装Gitlab</h2><a href="/blog/p/4adbd460/" title="Gitlab">Gitlab</a>

<h2 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h2><a href="/blog/p/f255ffad/" title="Docker">Docker</a>

<h2 id="安装文件传输工具"><a href="#安装文件传输工具" class="headerlink" title="安装文件传输工具"></a>安装文件传输工具</h2><ol>
<li><code>yum install lrzsz</code> 安装</li>
<li><code>rz</code> 向 <code>Linux</code> 传输文件</li>
<li><code>sz /path/file</code> 向 <code>Windows</code> 传输文件</li>
</ol>
<h2 id="安装V2ray"><a href="#安装V2ray" class="headerlink" title="安装V2ray"></a>安装V2ray</h2><blockquote>
<p><a href="https://www.v2ray.com/chapter_00/install.html" target="_blank" rel="noopener">https://www.v2ray.com/chapter_00/install.html</a></p>
</blockquote>
<ol>
<li><code>bash &lt;(curl -L -s https://install.direct/go.sh)</code> 下载并安装</li>
<li><code>vim /etc/v2ray/config.json</code> 修改config.json</li>
</ol>
<h3 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h3><ul>
<li><code>systemctl restart v2ray.service</code></li>
<li><code>systemctl status v2ray.service</code></li>
<li><code>chmod 777 -R /usr/bin/v2ray</code> 给予权限</li>
<li><code>vim /etc/rc.d/rc.local</code> 开机自启，增加下行代码</li>
<li><code>/bin/systemctl status v2ray.service</code> 开启服务</li>
<li><code>curl https://github.com/iyyann</code> 或者 <code>curl https://www.youtube.com</code> 测试</li>
</ul>
<h3 id="vim-x2F-etc-x2F-v2ray-x2F-config-json"><a href="#vim-x2F-etc-x2F-v2ray-x2F-config-json" class="headerlink" title="vim &#x2F;etc&#x2F;v2ray&#x2F;config.json"></a>vim &#x2F;etc&#x2F;v2ray&#x2F;config.json</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将下方的socks方式修改成http即可</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;inbounds&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;tag&quot;</span>: <span class="string">&quot;proxy&quot;</span>,</span><br><span class="line">      <span class="string">&quot;port&quot;</span>: <span class="number">10808</span>,</span><br><span class="line">      <span class="string">&quot;listen&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;protocol&quot;</span>: <span class="string">&quot;http&quot;</span>,<span class="comment">#已经将socks修改成了http</span></span><br><span class="line">      <span class="string">&quot;sniffing&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;enabled&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;destOverride&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;http&quot;</span>,</span><br><span class="line">          <span class="string">&quot;tls&quot;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="vim-x2F-etc-x2F-profile"><a href="#vim-x2F-etc-x2F-profile" class="headerlink" title="vim &#x2F;etc&#x2F;profile"></a>vim &#x2F;etc&#x2F;profile</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=&quot;http://192.168.3.150:10808&quot;</span><br><span class="line">export https_proxy=&quot;http://192.168.3.150:10808&quot;</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h3 id="开机自启-vim-x2F-etc-x2F-init-d-x2F-v2ray"><a href="#开机自启-vim-x2F-etc-x2F-init-d-x2F-v2ray" class="headerlink" title="开机自启 vim &#x2F;etc&#x2F;init.d&#x2F;v2ray"></a>开机自启 vim &#x2F;etc&#x2F;init.d&#x2F;v2ray</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">#</span><br><span class="line"># v2ray        Startup script for v2ray</span><br><span class="line">#</span><br><span class="line"># chkconfig: - 24 76</span><br><span class="line"># processname: v2ray</span><br><span class="line"># pidfile: /var/run/v2ray.pid</span><br><span class="line"># description: V2Ray proxy services</span><br><span class="line">#</span><br><span class="line"> </span><br><span class="line">### BEGIN INIT INFO</span><br><span class="line"># Provides:          v2ray</span><br><span class="line"># Required-Start:    $network $local_fs $remote_fs</span><br><span class="line"># Required-Stop:     $remote_fs</span><br><span class="line"># Default-Start:     2 3 4 5</span><br><span class="line"># Default-Stop:      0 1 6</span><br><span class="line"># Short-Description: V2Ray proxy services</span><br><span class="line"># Description:       V2Ray proxy services</span><br><span class="line">### END INIT INFO</span><br><span class="line"> </span><br><span class="line">DESC=v2ray</span><br><span class="line">NAME=v2ray</span><br><span class="line">DAEMON=/usr/bin/v2ray/v2ray</span><br><span class="line">PIDFILE=/var/run/$NAME.pid</span><br><span class="line">LOCKFILE=/var/lock/subsys/$NAME</span><br><span class="line">SCRIPTNAME=/etc/init.d/$NAME</span><br><span class="line">RETVAL=0</span><br><span class="line"> </span><br><span class="line">DAEMON_OPTS=&amp;quot;-config /etc/v2ray/config.json&amp;quot;</span><br><span class="line"> </span><br><span class="line"># Exit if the package is not installed</span><br><span class="line">[ -x $DAEMON ] || exit 0</span><br><span class="line"> </span><br><span class="line"># Read configuration variable file if it is present</span><br><span class="line">[ -r /etc/default/$NAME ] &amp;amp;&amp;amp; . /etc/default/$NAME</span><br><span class="line"> </span><br><span class="line"># Source function library.</span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"> </span><br><span class="line">start() &#123;</span><br><span class="line">  local pids=$(pgrep -f $DAEMON)</span><br><span class="line">  if [ -n &amp;quot;$pids&amp;quot; ]; then</span><br><span class="line">    echo &amp;quot;$NAME (pid $pids) is already running&amp;quot;</span><br><span class="line">    RETVAL=0</span><br><span class="line">    return 0</span><br><span class="line">  fi</span><br><span class="line"> </span><br><span class="line">  echo -n $&amp;quot;Starting $NAME: &amp;quot;</span><br><span class="line"> </span><br><span class="line">  mkdir -p /var/log/v2ray</span><br><span class="line">  $DAEMON $DAEMON_OPTS 1&amp;gt;/dev/null 2&amp;gt;&amp;amp;1 &amp;amp;</span><br><span class="line">  echo $! &amp;gt; $PIDFILE</span><br><span class="line"> </span><br><span class="line">  sleep 2</span><br><span class="line">  pgrep -f $DAEMON &amp;gt;/dev/null 2&amp;gt;&amp;amp;1</span><br><span class="line">  RETVAL=$?</span><br><span class="line">  if [ $RETVAL -eq 0 ]; then</span><br><span class="line">    success; echo</span><br><span class="line">    touch $LOCKFILE</span><br><span class="line">  else</span><br><span class="line">    failure; echo</span><br><span class="line">  fi</span><br><span class="line">  return $RETVAL</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">stop() &#123;</span><br><span class="line">  local pids=$(pgrep -f $DAEMON)</span><br><span class="line">  if [ -z &amp;quot;$pids&amp;quot; ]; then</span><br><span class="line">    echo &amp;quot;$NAME is not running&amp;quot;</span><br><span class="line">    RETVAL=0</span><br><span class="line">    return 0</span><br><span class="line">  fi</span><br><span class="line"> </span><br><span class="line">  echo -n $&amp;quot;Stopping $NAME: &amp;quot;</span><br><span class="line">  killproc -p $&#123;PIDFILE&#125; $&#123;NAME&#125;</span><br><span class="line">  RETVAL=$?</span><br><span class="line">  echo</span><br><span class="line">  [ $RETVAL = 0 ] &amp;amp;&amp;amp; rm -f $&#123;LOCKFILE&#125; $&#123;PIDFILE&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">reload() &#123;</span><br><span class="line">  echo -n $&amp;quot;Reloading $NAME: &amp;quot;</span><br><span class="line">  killproc -p $&#123;PIDFILE&#125; $&#123;NAME&#125; -HUP</span><br><span class="line">  RETVAL=$?</span><br><span class="line">  echo</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">rh_status() &#123;</span><br><span class="line">  status -p $&#123;PIDFILE&#125; $&#123;DAEMON&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"># See how we were called.</span><br><span class="line">case &amp;quot;$1&amp;quot; in</span><br><span class="line">  start)</span><br><span class="line">    rh_status &amp;gt;/dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&amp;amp; exit 0</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">  stop)</span><br><span class="line">    stop</span><br><span class="line">    ;;</span><br><span class="line">  status)</span><br><span class="line">    rh_status</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    ;;</span><br><span class="line">  restart)</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">  reload)</span><br><span class="line">    reload</span><br><span class="line">  ;;</span><br><span class="line">  *)</span><br><span class="line">    echo &amp;quot;Usage: $SCRIPTNAME &#123;start|stop|status|reload|restart&#125;&amp;quot; &amp;gt;&amp;amp;2</span><br><span class="line">    RETVAL=2</span><br><span class="line">  ;;</span><br><span class="line">esac</span><br><span class="line">exit $RETVAL</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/init.d/v2ray</span><br></pre></td></tr></table></figure>


<h2 id="打开AppImage"><a href="#打开AppImage" class="headerlink" title="打开AppImage"></a>打开AppImage</h2><ol>
<li><code>chmod +x 文件</code> 令其可执行</li>
<li><code>/path/AppImage --appimage-extract</code> 解压文件</li>
</ol>
<h2 id="安装-electron"><a href="#安装-electron" class="headerlink" title="安装 electron"></a>安装 electron</h2><ol>
<li><code>vim ~/.</code></li>
<li><code>electron_mirror=https://npm.taobao.org/mirrors/electron/</code> 更换源</li>
<li><code>sudo npm install -g electron --unsafe-perm=true --allow-root</code></li>
</ol>
<h2 id="相关命令-1"><a href="#相关命令-1" class="headerlink" title="相关命令"></a>相关命令</h2><ol>
<li><code>lsof</code> (lists openfiles)列出打开文件，在Unix中一切（包括网络套接口）都是文件。</li>
</ol>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列出谁在使用某个端口</span></span><br><span class="line">lsof -i:<span class="number">6379</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过某个进程号显示该进行打开的文件(可查看多个进程)</span></span><br><span class="line">lsof -p PID,PID2,PID3...</span><br><span class="line"></span><br><span class="line"><span class="comment">#找出正等候连接的端口</span></span><br><span class="line">lsof -i -sTCP:LISTEN<span class="string">` 等于 `</span>lsof -i | <span class="keyword">grep</span> -i ESTABLISHED</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看某个用户打开的文件</span></span><br><span class="line">lsof -u 用户名</span><br><span class="line"></span><br><span class="line"><span class="comment">#杀死指定用户所做的一切事情</span></span><br><span class="line"><span class="keyword">kill</span> -<span class="number">9</span> <span class="string">`lsof -t -u 用户名</span></span><br></pre></td></tr></table></figure>

<h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看服务器80端口是否打开</span></span><br><span class="line">firewall-<span class="keyword">cmd</span><span class="language-bash"> --query-port=80/tcp`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#打开80端口，`--permanent`永久生效，没有此参数重启后失效</span></span><br><span class="line">firewall-<span class="keyword">cmd</span><span class="language-bash"> --add-port=80/tcp --permanent`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#重启防火墙</span></span><br><span class="line">systemctl restart firewalld</span><br></pre></td></tr></table></figure>

<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># java 环境变量</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">JAVA_HOME</span>=/mnt/SSD/java/jdk-8u172-linux-x64</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$JAVA_HOME</span>/jre</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">CLASSPATH</span>=.:$JAVA_HOME/lib:$JRE_HOME/lib</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$JAVA_HOME/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># maven 环境变量</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">MAVEN_HOME</span>=/mnt/SSD/maven/apache-maven-3.5.3</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$MAVEN_HOME/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># Android 环境变量</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">ANDROID_HOME</span>=/mnt/1TB/Android/Sdk/android-sdk-linux</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$ANDROID_HOME/tools</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$ANDROID_HOME/tools/bin</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$ANDROID_HOME/platform-tools</span><br><span class="line"></span><br><span class="line"><span class="comment"># GO 环境变量</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">GO_HOME</span>=/mnt/SSD/go</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$GO_HOME/bin</span><br></pre></td></tr></table></figure>
<h2 id="扩容"><a href="#扩容" class="headerlink" title="扩容"></a>扩容</h2><ul>
<li><a href="https://www.cnblogs.com/ldsweely/p/9400583.html" target="_blank" rel="noopener">https://www.cnblogs.com/ldsweely/p/9400583.html</a></li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line">虚拟机vmware centos7 扩展磁盘空间</span><br><span class="line"><span class="number">0</span>、思路</span><br><span class="line">创建一个新的逻辑分区，将新的逻辑分区格式化ext3（或其他类型）的文件系统，mount到磁盘空间不够的文件系统，就跟原来的分区/文件系统一样的使用</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、准备</span><br><span class="line"><span class="number">1.1</span> 注意使用VMware自带的Expand功能不能有Snapshot存在，所以在expand之前先把所有的Snapshot删掉了</span><br><span class="line"></span><br><span class="line"><span class="number">1.2</span> 为了以防万一，把VMware虚拟机<span class="keyword">copy</span>了一份备用。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、查看挂载点</span><br><span class="line">[root@vnode1 ~]# df -h</span><br><span class="line">文件系统 容量 已用 可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root 36G 5.4G 31G 15% /</span></span><br><span class="line">devtmpfs <span class="number">3.9</span>G <span class="number">0</span> <span class="number">3.9</span>G <span class="number">0</span>% /dev</span><br><span class="line">tmpfs <span class="number">3.9</span>G <span class="number">0</span> <span class="number">3.9</span>G <span class="number">0</span>% <span class="regexp">/dev/</span>shm</span><br><span class="line">tmpfs <span class="number">3.9</span>G <span class="number">8.5</span>M <span class="number">3.9</span>G <span class="number">1</span>% /run</span><br><span class="line">tmpfs <span class="number">3.9</span>G <span class="number">0</span> <span class="number">3.9</span>G <span class="number">0</span>% <span class="regexp">/sys/</span>fs/cgroup</span><br><span class="line"><span class="regexp">/dev/</span>sda1 <span class="number">497</span>M <span class="number">125</span>M <span class="number">373</span>M <span class="number">26</span>% /boot</span><br><span class="line">tmpfs <span class="number">781</span>M <span class="number">0</span> <span class="number">781</span>M <span class="number">0</span>% <span class="regexp">/run/u</span>ser/<span class="number">0</span></span><br><span class="line"><span class="number">3</span>、扩展VMWare硬盘空间</span><br><span class="line"><span class="number">3.1</span> 关闭Vmware 的 Linux系统</span><br><span class="line"></span><br><span class="line"><span class="number">3.2</span> 在VMWare菜单中设置：</span><br><span class="line"></span><br><span class="line">VM -&gt; Settings… -&gt; Hardware -&gt; Hard Disk -&gt; Utilities -&gt; Expand</span><br><span class="line"></span><br><span class="line">输入你想要扩展到多少G，假设新增加了 <span class="number">40</span>G </span><br><span class="line">这里写图片描述</span><br><span class="line"></span><br><span class="line">这里写图片描述</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、对新增加的硬盘进行分区</span><br><span class="line">执行步骤：</span><br><span class="line"></span><br><span class="line">执行“fdisk <span class="regexp">/dev/</span>sda”，进入到fdisk</span><br><span class="line">输入p指令，查看已分区数量（有两个 <span class="regexp">/dev/</span>sda1 <span class="regexp">/dev/</span>sda2）</span><br><span class="line">输入 n &#123;<span class="keyword">new</span> partition&#125;指令，新增加一个分区</span><br><span class="line">输入p &#123;primary partition&#125;，分区类型选择为主分区</span><br><span class="line">输入分区号 <span class="number">3</span> &#123;partition number&#125; ，分区号选<span class="number">3</span>（上面显示我已经有<span class="number">2</span>个分区了）</span><br><span class="line">回车　　　　　　默认（起始扇区）</span><br><span class="line">回车　　　　　　默认（结束扇区）</span><br><span class="line">输入t &#123;change partition id&#125;指令，修改分区类型</span><br><span class="line">按提示输入刚才的分区号<span class="number">3</span></span><br><span class="line">输入分区类型 <span class="number">8</span>e &#123;Linux LVM partition&#125;</span><br><span class="line">输入w指令，将以上改动写入分区表</span><br><span class="line">最后完成，退出fdisk命令</span><br><span class="line">[root@vnode1 ~]# fdisk <span class="regexp">/dev/</span>sda</span><br><span class="line">欢迎使用 fdisk (util-linux <span class="number">2.23</span>.<span class="number">2</span>)。</span><br><span class="line"> </span><br><span class="line">更改将停留在内存中，直到您决定将更改写入磁盘。</span><br><span class="line">使用写入命令前请三思。</span><br><span class="line"> </span><br><span class="line">命令(输入 m 获取帮助)：p</span><br><span class="line">....</span><br><span class="line">设备 Boot Start End Blocks Id System</span><br><span class="line"><span class="regexp">/dev/</span>sda1 * <span class="number">2048</span> <span class="number">1026047</span> <span class="number">512000</span> <span class="number">83</span> Linux</span><br><span class="line"><span class="regexp">/dev/</span>sda2 <span class="number">1026048</span> <span class="number">83886079</span> <span class="number">41430016</span> <span class="number">8</span>e Linux LVM</span><br><span class="line"> </span><br><span class="line">命令(输入 m 获取帮助)：n</span><br><span class="line">Partition type:</span><br><span class="line">p primary (<span class="number">2</span> primary, <span class="number">0</span> extended, <span class="number">2</span> free)</span><br><span class="line">e extended</span><br><span class="line">Select (<span class="keyword">default</span> p): p</span><br><span class="line">分区号 (<span class="number">3</span>,<span class="number">4</span>，默认 <span class="number">3</span>)：<span class="number">3</span></span><br><span class="line">起始 扇区 (<span class="number">83886080</span>-<span class="number">167772159</span>，默认为 <span class="number">83886080</span>)：</span><br><span class="line">将使用默认值 <span class="number">83886080</span></span><br><span class="line">Last 扇区, +扇区 or +<span class="keyword">size</span>&#123;K,M,G&#125; (<span class="number">83886080</span>-<span class="number">167772159</span>，默认为 <span class="number">167772159</span>)：</span><br><span class="line">将使用默认值 <span class="number">167772159</span></span><br><span class="line">分区 <span class="number">3</span> 已设置为 Linux 类型，大小设为 <span class="number">40</span> GiB</span><br><span class="line"> </span><br><span class="line">命令(输入 m 获取帮助)：t</span><br><span class="line">分区号 (<span class="number">1</span>-<span class="number">3</span>，默认 <span class="number">3</span>)：<span class="number">3</span></span><br><span class="line">Hex 代码(输入 L 列出所有代码)：<span class="number">8</span>e</span><br><span class="line">已将分区“Linux”的类型更改为“Linux LVM”</span><br><span class="line"> </span><br><span class="line">命令(输入 m 获取帮助)：w</span><br><span class="line">The partition table has been altered!</span><br><span class="line"> </span><br><span class="line">Calling ioctl() to re-<span class="keyword">read</span> partition table.</span><br><span class="line"> </span><br><span class="line">WARNING: Re-reading the partition table failed with error <span class="number">16</span>: 设备或资源忙.</span><br><span class="line">The kernel still uses the old table. The <span class="keyword">new</span> table will be used at</span><br><span class="line">the <span class="keyword">next</span> reboot or after you run partprobe(<span class="number">8</span>) or kpartx(<span class="number">8</span>)</span><br><span class="line">正在同步磁盘。</span><br><span class="line">重启系统: </span><br><span class="line">[root@vnode1 ~]# shutdown -r now （很重要）</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、对新增加的硬盘格式化</span><br><span class="line">[root@vnode1 ~]# mkfs.ext3 <span class="regexp">/dev/</span>sda3</span><br><span class="line">mke2fs <span class="number">1.42</span>.<span class="number">9</span> (<span class="number">28</span>-Dec-<span class="number">2013</span>)</span><br><span class="line">文件系统标签=</span><br><span class="line">OS type: Linux</span><br><span class="line">块大小=<span class="number">4096</span> (log=<span class="number">2</span>)</span><br><span class="line">分块大小=<span class="number">4096</span> (log=<span class="number">2</span>)</span><br><span class="line">Stride=<span class="number">0</span> blocks, Stripe width=<span class="number">0</span> blocks</span><br><span class="line"><span class="number">2621440</span> inodes, <span class="number">10485760</span> blocks</span><br><span class="line"><span class="number">524288</span> blocks (<span class="number">5.00</span>%) reserved <span class="keyword">for</span> the <span class="keyword">super</span> user</span><br><span class="line">第一个数据块=<span class="number">0</span></span><br><span class="line">Maximum filesystem blocks=<span class="number">4294967296</span></span><br><span class="line"><span class="number">320</span> block groups</span><br><span class="line"><span class="number">32768</span> blocks per <span class="keyword">group</span>, <span class="number">32768</span> fragments per <span class="keyword">group</span></span><br><span class="line"><span class="number">8192</span> inodes per <span class="keyword">group</span></span><br><span class="line">Superblock backups stored on blocks:</span><br><span class="line"><span class="number">32768</span>, <span class="number">98304</span>, <span class="number">163840</span>, <span class="number">229376</span>, <span class="number">294912</span>, <span class="number">819200</span>, <span class="number">884736</span>, <span class="number">1605632</span>, <span class="number">2654208</span>,</span><br><span class="line"><span class="number">4096000</span>, <span class="number">7962624</span></span><br><span class="line"> </span><br><span class="line">Allocating <span class="keyword">group</span> tables: 完成</span><br><span class="line">正在写入inode表: 完成</span><br><span class="line">Creating journal (<span class="number">32768</span> blocks): 完成</span><br><span class="line">Writing superblocks and filesystem accounting information: 完成</span><br><span class="line"><span class="number">5</span>、添加新LVM到已有的LVM组，实现扩容</span><br><span class="line">[root@vnode1 ~]# lvm</span><br><span class="line">lvm&gt; pvcreate <span class="regexp">/dev/</span>sda3</span><br><span class="line">WARNING: ext3 signature detected on <span class="regexp">/dev/</span>sda3 at offset <span class="number">1080</span>. Wipe it? [y/n]: y</span><br><span class="line">Wiping ext3 signature on <span class="regexp">/dev/</span>sda3.</span><br><span class="line">Physical volume <span class="string">&quot;/dev/sda3&quot;</span> successfully created</span><br><span class="line">lvm&gt; vgextend centos <span class="regexp">/dev/</span>sda3</span><br><span class="line">Volume <span class="keyword">group</span> <span class="string">&quot;centos&quot;</span> successfully extended</span><br><span class="line">lvm&gt; lvextend -L +<span class="number">39.9</span>G <span class="regexp">/dev/m</span>apper/centos-root</span><br><span class="line">Rounding <span class="keyword">size</span> to boundary between physical extents: <span class="number">39.90</span> GiB</span><br><span class="line"><span class="keyword">Size</span> of logical volume centos/root changed <span class="keyword">from</span> <span class="number">35.47</span> GiB (<span class="number">9080</span> extents) to <span class="number">75.37</span> GiB (<span class="number">19295</span> extents).</span><br><span class="line">Logical volume root successfully resized.</span><br><span class="line">lvm&gt; pvdisplay</span><br><span class="line">--- Physical volume ---</span><br><span class="line">PV Name <span class="regexp">/dev/</span>sda2</span><br><span class="line">VG Name centos</span><br><span class="line">PV <span class="keyword">Size</span> <span class="number">39.51</span> GiB / not usable <span class="number">3.00</span> MiB</span><br><span class="line">Allocatable yes (but full)</span><br><span class="line">PE <span class="keyword">Size</span> <span class="number">4.00</span> MiB</span><br><span class="line">Total PE <span class="number">10114</span></span><br><span class="line">Free PE <span class="number">0</span></span><br><span class="line">Allocated PE <span class="number">10114</span></span><br><span class="line">PV UUID vtNvX3-b1yw-ePoh-YGHQ-tDhL-x0ru-mfts3k</span><br><span class="line"> </span><br><span class="line">--- Physical volume ---</span><br><span class="line">PV Name <span class="regexp">/dev/</span>sda3</span><br><span class="line">VG Name centos</span><br><span class="line">PV <span class="keyword">Size</span> <span class="number">40.00</span> GiB / not usable <span class="number">4.00</span> MiB</span><br><span class="line">Allocatable yes</span><br><span class="line">PE <span class="keyword">Size</span> <span class="number">4.00</span> MiB</span><br><span class="line">Total PE <span class="number">10239</span></span><br><span class="line">Free PE <span class="number">34</span></span><br><span class="line">Allocated PE <span class="number">10205</span></span><br><span class="line">PV UUID jWqvcF-R53u-ZeAy-zO2L-PbtI-<span class="number">51</span>VP-yHNZ1g</span><br><span class="line"> </span><br><span class="line">lvm&gt; quit</span><br><span class="line">Exiting.</span><br><span class="line">[root@vnode1 ~]#</span><br><span class="line">备注：</span><br><span class="line"></span><br><span class="line">lvm　　　　　　　　　　　　 进入lvm管理</span><br><span class="line">lvm&gt; pvcreate <span class="regexp">/dev/</span>sda3 这是初始化刚才的分区，必须的</span><br><span class="line">lvm&gt;vgextend centos <span class="regexp">/dev/</span>sda3 将初始化过的分区加入到虚拟卷组vg_dc01</span><br><span class="line">lvm&gt;lvextend -L +<span class="number">39.9</span>G <span class="regexp">/dev/m</span>apper/centos-root　　扩展已有卷的容量（注意容量大小）</span><br><span class="line">lvm&gt;pvdisplay　　　　　　　　　　　　　　 查看卷容量，这时你会看到一个很大的卷了</span><br><span class="line">lvm&gt;quit　　　　　　　　　　　　　　 　　　退出</span><br><span class="line">以上只是卷扩容了，下面是文件系统的真正扩容，输入以下命令：</span><br><span class="line"></span><br><span class="line">[root@vnode1 ~]# resize2fs <span class="regexp">/dev/m</span>apper/centos-root</span><br><span class="line">resize2fs <span class="number">1.42</span>.<span class="number">9</span> (<span class="number">28</span>-Dec-<span class="number">2013</span>)</span><br><span class="line">resize2fs: Bad magic number in <span class="keyword">super</span>-block 当尝试打开 <span class="regexp">/dev/m</span>apper/centos-root 时</span><br><span class="line">找不到有效的文件系统超级块.</span><br><span class="line">报错：当尝试打开 <span class="regexp">/dev/m</span>apper/centos-root 时 找不到有效的文件系统超级块</span><br><span class="line"></span><br><span class="line">因为我的centos7的某些分区用的是xfs的文件系统（使用df -T查看即可知道）</span><br><span class="line"></span><br><span class="line">[root@vnode1 ~]# df -T</span><br><span class="line">文件系统                           类型          <span class="number">1</span>K-块        已用        可用          已用%  挂载点</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root   xfs           37173520 5574340  31599180  15%      /</span></span><br><span class="line">devtmpfs 　　                   devtmpfs  <span class="number">3987400</span>   <span class="number">0</span>              <span class="number">3987400</span>    <span class="number">0</span>%       /dev</span><br><span class="line">tmpfs                                 tmpfs        <span class="number">3997856</span>   <span class="number">0</span>              <span class="number">3997856</span>    <span class="number">0</span>%      <span class="regexp">/dev/</span>shm</span><br><span class="line">tmpfs                                 tmpfs        <span class="number">3997856</span>   <span class="number">8628</span>        <span class="number">3989228</span>     <span class="number">1</span>%     /run</span><br><span class="line">tmpfs                                 tmpfs        <span class="number">3997856</span>   <span class="number">0</span>               <span class="number">3997856</span>     <span class="number">0</span>%    <span class="regexp">/sys/</span>fs/cgroup</span><br><span class="line"><span class="regexp">/dev/</span>sda1                          xfs            <span class="number">508588</span>      <span class="number">127152</span>    <span class="number">381436</span>       <span class="number">26</span>%  /boot</span><br><span class="line">tmpfs                                tmpfs         <span class="number">799572</span>      <span class="number">0</span>              <span class="number">799572</span>       <span class="number">0</span>%   run<span class="regexp">/user/</span><span class="number">0</span></span><br><span class="line">[root@vnode1 ~]#</span><br><span class="line">将resize2fs替换为xfs_growfs，重新执行一遍即可，如下：</span><br><span class="line"></span><br><span class="line">[root@vnode1 ~]# xfs_growfs <span class="regexp">/dev/m</span>apper/centos-root</span><br><span class="line">meta-data=<span class="regexp">/dev/m</span>apper/centos-root isize=<span class="number">256</span> agcount=<span class="number">4</span>, agsize=<span class="number">2324480</span> blks</span><br><span class="line">= sectsz=<span class="number">512</span> attr=<span class="number">2</span>, projid32bit=<span class="number">1</span></span><br><span class="line">= crc=<span class="number">0</span> finobt=<span class="number">0</span></span><br><span class="line">data = bsize=<span class="number">4096</span> blocks=<span class="number">9297920</span>, imaxpct=<span class="number">25</span></span><br><span class="line">= sunit=<span class="number">0</span> swidth=<span class="number">0</span> blks</span><br><span class="line">naming =version <span class="number">2</span> bsize=<span class="number">4096</span> ascii-ci=<span class="number">0</span> ftype=<span class="number">0</span></span><br><span class="line">log =internal bsize=<span class="number">4096</span> blocks=<span class="number">4540</span>, version=<span class="number">2</span></span><br><span class="line">= sectsz=<span class="number">512</span> sunit=<span class="number">0</span> blks, lazy-<span class="keyword">count</span>=<span class="number">1</span></span><br><span class="line">realtime =none extsz=<span class="number">4096</span> blocks=<span class="number">0</span>, rtextents=<span class="number">0</span></span><br><span class="line">data blocks changed <span class="keyword">from</span> <span class="number">9297920</span> to <span class="number">19758080</span></span><br><span class="line">最后再运行下：df -h </span><br><span class="line">即可看到扩容后的磁盘空间</span><br><span class="line"></span><br><span class="line">[root@vnode1 ~]# df -h</span><br><span class="line">文件系统 容量 已用 可用 已用% 挂载点</span><br><span class="line"><span class="regexp">/dev/m</span>apper<span class="regexp">/centos-root 76G 5.4G 71G 8% /</span></span><br><span class="line">devtmpfs <span class="number">3.9</span>G <span class="number">0</span> <span class="number">3.9</span>G <span class="number">0</span>% /dev</span><br><span class="line">tmpfs <span class="number">3.9</span>G <span class="number">0</span> <span class="number">3.9</span>G <span class="number">0</span>% <span class="regexp">/dev/</span>shm</span><br><span class="line">tmpfs <span class="number">3.9</span>G <span class="number">8.5</span>M <span class="number">3.9</span>G <span class="number">1</span>% /run</span><br><span class="line">tmpfs <span class="number">3.9</span>G <span class="number">0</span> <span class="number">3.9</span>G <span class="number">0</span>% <span class="regexp">/sys/</span>fs/cgroup</span><br><span class="line"><span class="regexp">/dev/</span>sda1 <span class="number">497</span>M <span class="number">125</span>M <span class="number">373</span>M <span class="number">26</span>% /boot</span><br><span class="line">tmpfs <span class="number">781</span>M <span class="number">0</span> <span class="number">781</span>M <span class="number">0</span>% <span class="regexp">/run/u</span>ser/<span class="number">0</span></span><br><span class="line">ps:修复 unknown 区  vgreduce --removemissing centos</span><br><span class="line"></span><br><span class="line">  --- Physical volume ---</span><br><span class="line">  PV Name               [unknown]</span><br><span class="line">  VG Name               centos</span><br><span class="line">  PV <span class="keyword">Size</span>               <span class="number">10.00</span> GiB / not usable <span class="number">4.00</span> MiB</span><br><span class="line">  Allocatable           yes</span><br><span class="line">  PE <span class="keyword">Size</span>               <span class="number">4.00</span> MiB</span><br><span class="line">  Total PE              <span class="number">2559</span></span><br><span class="line">  Free PE               <span class="number">2559</span></span><br><span class="line">  Allocated PE          <span class="number">0</span></span><br><span class="line">  PV UUID               VCwaaP-hhX8-YcSg-Cqji-ctob-AAod-wRnOLO</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/blog/p/41057581/" class="prev">上一篇</a><a href="/blog/p/86635873/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = 'p/aa9fa5e8/';
var disqus_title = 'Linux测试机构建';
var disqus_url = 'https://ayou129.github.io/blog/p/aa9fa5e8/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2022 <a href="https://ayou129.github.io/blog">阿尤</a>.</p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>